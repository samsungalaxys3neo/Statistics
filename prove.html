<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Homework 2 | Statistics & Cybersecurity</title>
  <link href="https://fonts.cdnfonts.com/css/cascadia-code" rel="stylesheet">
  <style>
    :root {
      --bg: #0a0010;
      --accent: #b6ffb6;
      --accent-dim: rgba(182,255,182,.25);
      --glow: #b6ffb6;
      --text: #f4fff7;
      --subtitle: #8aff8a;
    }
    body.cyberpunk-mode {
      --bg: #000;
      --accent: #ff00cc;
      --accent-dim: rgba(255,0,204,.25);
      --glow: #ff00cc;
      --text: #eaffef;
      --subtitle: #ff88ff;
    }

    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%}
    body{
      background:var(--bg);
      color:var(--text);
      font-family:'Cascadia Code', monospace;
      overflow-x:hidden;
      padding:2rem;
      transition:background .6s ease, color .6s ease;
    }

    #toggle{
      position:fixed;top:16px;right:16px;z-index:10;
      background:linear-gradient(145deg,var(--accent),var(--glow));
      color:#000;border:none;
      padding:.55rem 1rem;border-radius:10px;cursor:pointer;
      font-weight:bold;box-shadow:0 0 12px var(--glow),inset 0 0 5px rgba(255,255,255,.2);
      transition:transform .25s, box-shadow .25s;
    }
    #toggle:hover{transform:scale(1.05);box-shadow:0 0 18px var(--glow);}

    .container{
      max-width:900px;margin:6rem auto;padding:2rem 2.5rem;
      background:rgba(0,0,0,0.85);
      border:1px solid var(--accent-dim);
      border-radius:12px;
      box-shadow:0 0 20px var(--accent-dim), inset 0 0 10px rgba(255,255,255,0.05);
    }
    h1,h2,h3,h4{color:var(--accent);text-shadow:0 0 8px var(--glow);text-align:center;}
    h1{font-size:2.3rem;margin-bottom:.4rem;}
    h2{font-size:1.2rem;margin-bottom:1.8rem;opacity:.9;}
    h3{margin-top:1.8rem;margin-bottom:.8rem;color:var(--subtitle);}
    h4{margin-top:1rem;margin-bottom:.5rem;font-size:1rem;color:var(--subtitle);}
    p{margin-bottom:1rem;}

    .sql-box{
      background:#171717;
      color:#ffffff;
      border-radius:10px;
      padding:1rem 1.2rem;
      font-family:'Cascadia Code', monospace;
      overflow-x:auto;
      margin-top:1rem;
      margin-bottom:1.5rem;
      box-shadow:inset 0 0 8px rgba(0,0,0,0.15);
    }
    .sql-keyword{color:#0074d9;font-weight:bold;}
    .sql-string{color:#b03060;}
    .sql-number{color:#2e8b57;}

    table{
      width:100%;
      border-collapse:collapse;
      margin-top:1rem;
      color:var(--text);
      font-size:.9rem;
    }
    th,td{
      border:1px solid var(--accent-dim);
      padding:.5rem;
      text-align:center;
    }
    th{color:var(--accent);text-shadow:0 0 6px var(--glow);}

    .btn{
      display:block;margin:1rem auto;background:transparent;border:1px solid var(--accent-dim);
      color:var(--accent);padding:.5rem .9rem;border-radius:8px;cursor:pointer;text-shadow:0 0 8px var(--glow);transition:.25s;
    }
    .btn:hover{background:var(--accent);color:#000;}

    #outputUni, #outputBi {
      background: rgba(0, 0, 0, 0.8);
      padding: 1rem;
      border-radius: 10px;
      font-family: 'Cascadia Code', monospace;
      font-size: 0.95rem;
      line-height: 1.5;
      color: var(--accent);
      box-shadow: 0 0 15px var(--accent-dim), inset 0 0 10px rgba(255,255,255,0.05);
      white-space: pre-wrap;
      min-height: 80px;
      overflow-wrap: break-word;
    }

    canvas{display:block;margin:2rem auto;background:rgba(0,0,0,0.8);border-radius:10px;box-shadow:0 0 20px var(--accent-dim);width:100%;max-width:850px;height:350px;}
    textarea{width:100%;margin:1rem 0;padding:1rem;border-radius:8px;border:1px solid var(--accent-dim);font-family:'Cascadia Code',monospace;background:#171717;color:var(--accent);height:200px;resize:none;overflow-y:auto;}
    select{display:block;margin:1rem auto;padding:.6rem;border-radius:8px;border:1px solid var(--accent-dim);background:#171717;color:var(--accent);}
  </style>
</head>
<body>
<button id="toggle">Cyberpunk Mode</button>

<div class="container">
  <h1>Homework_2</h1>
  <h2>Dataset and Distributions in Cybersecurity</h2>

  <h3>&gt; Step 1 ‚Äì Create a Simple Dataset</h3>
  <p>This step shows how to build a small dataset representing network packets.</p>
  <div class="sql-box">
    <span class="sql-keyword">CREATE TABLE</span> NetworkTraffic (<br>
    &nbsp;&nbsp;id <span class="sql-keyword">INT</span> <span class="sql-keyword">PRIMARY KEY</span>,<br>
    &nbsp;&nbsp;source_ip <span class="sql-keyword">VARCHAR</span>(<span class="sql-number">50</span>),<br>
    &nbsp;&nbsp;destination_ip <span class="sql-keyword">VARCHAR</span>(<span class="sql-number">50</span>),<br>
    &nbsp;&nbsp;packet_size <span class="sql-keyword">INT</span>,<br>
    &nbsp;&nbsp;response_time_ms <span class="sql-keyword">INT</span><br>
    );
  </div>

  <h3>&gt; Step 2 ‚Äì Populate the Table</h3>
  <p>We simulate a few entries of network traffic data:</p>
  <div class="sql-box">
    <span class="sql-keyword">INSERT INTO</span> NetworkTraffic <span class="sql-keyword">VALUES</span> (...);
  </div>

  <h3>&gt; Step 3 ‚Äì Analyze the Dataset</h3>
  <p>We can now compute both univariate and bivariate distributions to understand how packet size behaves and correlates with response time.</p>

  <table id="dataTable"></table>
  <h4>‚ñ∂ Univariate Distribution</h4>
  <button class="btn" id="analyzeUni">&gt; Compute Univariate Distribution()</button>
  <pre id="outputUni"></pre>

  <h4>‚ñ∂ Bivariate Distribution</h4>
  <button class="btn" id="analyzeBi">&gt; Compute Correlation()</button>
  <pre id="outputBi"></pre>

  <hr style="margin:2.5rem 0;border:none;border-top:2px solid var(--accent-dim);">

  <h2>Caesar Cipher: Letter Frequency Visualization</h2>
  <p>Let's analyze how often each letter appears in a given text. This kind of analysis can reveal structure even in encrypted data.</p>
  <textarea id="inputText"></textarea>
  <button class="btn" id="analyzeText">&gt; Analyze Letter Distribution()</button>
  <canvas id="letterChart" width="850" height="350"></canvas>

  <h3>&gt; Step 5 ‚Äì Encrypt the Text (Caesar Cipher)</h3>
  <p>The Caesar cipher shifts each letter by a fixed number. Try different keys to see how the distribution changes!</p>
  <label for="shiftSelect" style="display:block;text-align:center;margin-top:1rem;font-weight:bold;">Select shift key:</label>
  <div style="display:flex;justify-content:center;align-items:center;gap:.6rem;">
    <select id="shiftSelect"></select>
  </div>
  <button class="btn" id="encryptBtn">&gt; Encrypt Text</button>
  <textarea id="encryptedText" readonly></textarea>
  <div class="terminal-line" id="encInfo"><p>&gt; Encrypted text will appear here. Select a shift and press Encrypt.</p></div>
  <canvas id="encryptedChart" width="850" height="350"></canvas>

  <h3>&gt; Step 6 ‚Äì Auto Decryption by Frequency Analysis üîç</h3>
  <div class="terminal-line"><p><strong>What this does</strong> ‚Äî The automatic decryptor compares candidate decryptions' letter-frequency distributions with the expected Italian distribution to estimate the most likely shift.</p></div>
  <div class="terminal-line"><p><strong>Algorithm summary</strong> ‚Äî For shift=1..25: decrypt, count letters A‚ÄìZ, normalize to percentages, compute sum-of-squared-differences vs Italian profile; choose the shift with smallest score.</p></div>
  <button class="btn" id="decryptBtn">&gt; Auto-Decrypt Text</button>
  <textarea id="decryptedText" readonly style="height:160px;margin-top:1rem;"></textarea>
  <canvas id="decryptedChart" width="850" height="350" style="margin-top:1rem;"></canvas>
</div>

<script>
// Toggle mode
const toggleBtn=document.getElementById('toggle');
let cyberpunkMode=false;
function setMode(isCyberpunk){
  cyberpunkMode=isCyberpunk;
  document.body.classList.toggle('cyberpunk-mode',cyberpunkMode);
  toggleBtn.textContent=cyberpunkMode?'Matrix Mode':'Cyberpunk Mode';
}
setMode(false);
toggleBtn.addEventListener('click',()=>setMode(!cyberpunkMode));

// Dataset generator
function generatePackets(){
  const baseIPs=['192.168.1.2','192.168.1.5','192.168.1.8','192.168.1.10'];
  const packets=[];
  for(let i=1;i<=10;i++){
    const src=baseIPs[Math.floor(Math.random()*baseIPs.length)];
    const dst='10.0.0.7';
    const size=[480,500,520,540,560,600,620,640,700][Math.floor(Math.random()*9)];
    const time=Math.round(size/5 + Math.random()*50 + 60);
    packets.push({id:i,src,dst,size,time});
  }
  return packets;
}
let packets=generatePackets();
const table=document.getElementById('dataTable');
function renderTable(){
  table.innerHTML='<tr><th>ID</th><th>Source IP</th><th>Destination IP</th><th>Packet Size</th><th>Response Time (ms)</th></tr>'+
  packets.map(p=>`<tr><td>${p.id}</td><td>${p.src}</td><td>${p.dst}</td><td>${p.size}</td><td>${p.time}</td></tr>`).join('');
}
renderTable();

// Typewriter
function typeWriter(element, text, speed=15){
  element.textContent='';
  let i=0;
  const interval=setInterval(()=>{
    if(i<text.length){
      element.textContent=text.substring(0,i+1);
      i++;
    } else clearInterval(interval);
  }, speed);
}

// Univariate
const outputUni=document.getElementById('outputUni');
document.getElementById('analyzeUni').addEventListener('click',()=>{
  const sizes=packets.map(p=>p.size);
  const mean=sizes.reduce((a,b)=>a+b,0)/sizes.length;
  const sd=Math.sqrt(sizes.map(x=>(x-mean)**2).reduce((a,b)=>a+b)/sizes.length);
  const freq={};
  sizes.forEach(s=>freq[s]=(freq[s]||0)+1);
  let res='> Packet Size Distribution\n';
  for(const [k,v] of Object.entries(freq)) res+=`Size ${k} bytes ‚Üí ${v} packet(s)\n`;
  res+=`\n> Mean: ${mean.toFixed(2)} bytes\n> Std Dev: ${sd.toFixed(2)} bytes`;
  typeWriter(outputUni,res,8);
});

// Bivariate
const outputBi=document.getElementById('outputBi');
document.getElementById('analyzeBi').addEventListener('click',()=>{
  const x=packets.map(p=>p.size);
  const y=packets.map(p=>p.time);
  const meanX=x.reduce((a,b)=>a+b,0)/x.length;
  const meanY=y.reduce((a,b)=>a+b,0)/y.length;
  const num=x.map((xi,i)=>(xi-meanX)*(y[i]-meanY)).reduce((a,b)=>a+b,0);
  const den=Math.sqrt(x.map(xi=>(xi-meanX)**2).reduce((a,b)=>a+b,0)*y.map(yi=>(yi-meanY)**2).reduce((a,b)=>a+b,0));
  const corr=(num/den).toFixed(3);
  typeWriter(outputBi,`> Correlation between packet size and response time: ${corr}`,12);
});

// Letter frequency + chart
function countLetters(text){
  const freq={};
  for(let i=65;i<=90;i++)freq[String.fromCharCode(i)]=0;
  for(let c of text.toUpperCase())if(c>='A'&&c<='Z')freq[c]++;
  return freq;
}
function drawLetterChartWithCount(freq,canvasId){
  const canvas=document.getElementById(canvasId);
  if(!canvas) return;
  const ctx=canvas.getContext('2d');
  ctx.clearRect(0,0,canvas.width,canvas.height);
  const letters=Object.keys(freq);
  const values=letters.map(l=>freq[l]);
  const max=Math.max(...values,1);
  const barWidth=(canvas.width-100)/letters.length;
  ctx.fillStyle='#00ffcc';
  ctx.font='14px Cascadia Code';
  ctx.textAlign='center';
  ctx.strokeStyle='rgba(182,255,182,0.4)';
  ctx.lineWidth=2;
  ctx.beginPath();ctx.moveTo(50,300);ctx.lineTo(800,300);ctx.stroke();
  letters.forEach((l,i)=>{
    const x=60+i*barWidth;const h=(values[i]/max)*220;
    ctx.fillRect(x,300-h,barWidth-5,h);
    ctx.fillStyle='#ffeb3b';ctx.font='bold 16px Cascadia Code';
    ctx.fillText(values[i],x+(barWidth-5)/2,300-h-10);
    ctx.fillStyle='#b6ffb6';ctx.font='14px Cascadia Code';
    ctx.fillText(l,x+(barWidth-5)/2,320);
    ctx.fillStyle='#00ffcc';
  });
}
document.getElementById('analyzeText').addEventListener('click',()=>{
  const text=document.getElementById('inputText').value;
  const freq=countLetters(text);
  drawLetterChartWithCount(freq,'letterChart');
});

// Caesar cipher
const inputText=document.getElementById('inputText');
const shiftSelect=document.getElementById('shiftSelect');
for(let i=1;i<=25;i++){
  const opt=document.createElement('option');
  opt.value=i;opt.textContent=`Shift ${i}`;
  shiftSelect.appendChild(opt);
}
function caesarCipher(text,shift){
  return text.replace(/[A-Za-z]/g,c=>{
    const base=c>='a'&&c<='z'?97:65;
    return String.fromCharCode(((c.charCodeAt(0)-base+shift)%26)+base);
  });
}
document.getElementById('encryptBtn').addEventListener('click',()=>{
  const shift=parseInt(shiftSelect.value);
  const ciphered=caesarCipher(inputText.value,shift);
  document.getElementById('encryptedText').value=ciphered;
  const freq=countLetters(ciphered);
  drawLetterChartWithCount(freq,'encryptedChart');
});

// Auto decrypt (fixed)
const italianFreq={
  'A':11.0,'B':1.05,'C':4.30,'D':3.39,'E':12.0,
  'F':1.01,'G':1.65,'H':1.43,'I':10.3,'L':5.70,
  'M':2.87,'N':7.02,'O':10.1,'P':2.96,'Q':0.45,
  'R':6.19,'S':5.48,'T':6.97,'U':3.3,'V':1.75,'Z':0.85
};
function normalizeFreq(freq){
  const total=Object.values(freq).reduce((a,b)=>a+b,0)||1;
  const norm={};for(let l in freq)norm[l]=(freq[l]/total)*100;return norm;
}
function compareDistributions(freq1,freq2){
  let sum=0;for(let l in freq2){const f1=freq1[l]||0
